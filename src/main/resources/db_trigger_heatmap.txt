-------------------------DAILY--------------------------

CREATE OR REPLACE FUNCTION refresh_daily_prices_heatmap()
RETURNS TRIGGER
LANGUAGE plpgsql
AS $$
BEGIN
    REFRESH MATERIALIZED VIEW daily_prices_performance_view;
    RETURN NULL;
END;
$$;

CREATE TRIGGER refresh_daily_prices_heatmap_trigger
AFTER INSERT or UPDATE ON daily_prices
FOR EACH ROW
EXECUTE FUNCTION refresh_daily_prices_heatmap();

-- drop TRIGGER refresh_daily_prices_heatmap_trigger on daily_prices
-- drop function refresh_daily_prices_heatmap


-------------------------WEEKLY--------------------------

CREATE OR REPLACE FUNCTION refresh_weekly_prices_heatmap()
RETURNS TRIGGER
LANGUAGE plpgsql
AS $$
BEGIN
    REFRESH MATERIALIZED VIEW weekly_prices_performance_view;
    RETURN NULL;
END;
$$;

CREATE TRIGGER refresh_weekly_prices_heatmap_trigger
AFTER INSERT or UPDATE ON weekly_prices
FOR EACH ROW
EXECUTE FUNCTION refresh_weekly_prices_heatmap();

-- drop TRIGGER refresh_weekly_prices_heatmap_trigger on weekly_prices
-- drop function refresh_weekly_prices_heatmap

-------------------------MONTHLY--------------------------


CREATE OR REPLACE FUNCTION refresh_monthly_prices_heatmap()
RETURNS TRIGGER
LANGUAGE plpgsql
AS $$
BEGIN
    REFRESH MATERIALIZED VIEW monthly_prices_performance_view;
    RETURN NULL;
END;
$$;

CREATE TRIGGER refresh_monthly_prices_heatmap_trigger
AFTER INSERT or UPDATE ON monthly_prices
FOR EACH ROW
EXECUTE FUNCTION refresh_monthly_prices_heatmap();

-- drop TRIGGER refresh_monthly_prices_heatmap_trigger on monthly_prices
-- drop function refresh_monthly_prices_heatmap

-------------------------YEARLY--------------------------

CREATE OR REPLACE FUNCTION refresh_yearly_prices_heatmap()
RETURNS TRIGGER
LANGUAGE plpgsql
AS $$
BEGIN
    REFRESH MATERIALIZED VIEW yearly_prices_performance_view;
    RETURN NULL;
END;
$$;

CREATE TRIGGER refresh_yearly_prices_heatmap_trigger
AFTER INSERT or UPDATE ON yearly_prices
FOR EACH ROW
EXECUTE FUNCTION refresh_yearly_prices_heatmap();

-- drop TRIGGER refresh_yearly_prices_heatmap_trigger on yearly_prices
-- drop function refresh_yearly_prices_heatmap